{% extends "agents/base.html" %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="{% static 'agents/css/deal.css' %}">

<div class="deal-page">
    <div class="deal-header">
        <h1>Сделка #{{ deal.id }}</h1>
        <p>{{ deal.property.address }}</p>
    </div>

    <div class="deal-info">
        <div class="deal-section">
            <h3>Участники</h3>
            <p>Собственник: {{ deal.owner.name }} ({{ deal.owner.phone }})</p>
            <p>Арендатор: {{ deal.tenant.name }} ({{ deal.tenant.phone }})</p>
            <p>Агент: {{ deal.agent.user.name }}</p>
        </div>

        <div class="deal-section">
            <h3>Документы</h3>
            <a href="#" class="ui-button ui-button--transparent">Договор аренды</a>
            <a href="#" class="ui-button ui-button--transparent">Акт приема-передачи</a>
        </div>

        <div class="deal-section">
            <h3>Подписание</h3>
            <p>Собственник: {{ deal.get_status_display }}</p>
            <p>Арендатор: {{ deal.get_status_display }}</p>
            <form method="post">
                {% csrf_token %}
                <button type="submit" class="ui-button ui-button--primary">Подписать</button>
            </form>
        </div>

        <div class="deal-section">
            <h3>Оплата</h3>
            <p>Сумма аренды: {{ deal.rent_amount }} ₽</p>
            <p>Комиссия: {{ deal.calculate_commission.our_commission }} ₽</p>
            <p>Страховка: {{ deal.calculate_commission.insurance_commission }} ₽</p>
            <p><strong>Итого к оплате: {{ deal.calculate_commission.total }} ₽</strong></p>
        </div>
    </div>
</div>
{% endblock %}